<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STM32矩阵灯控制器</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36D399',
                        danger: '#F87272',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .matrix-cell {
                @apply w-6 h-6 md:w-8 md:h-8 rounded-sm transition-all duration-200 cursor-pointer border border-gray-200;
            }
            .control-btn {
                @apply px-4 py-2 rounded-lg transition-all duration-200 flex items-center justify-center gap-2;
            }
            .control-btn-primary {
                @apply bg-primary text-white hover:bg-primary/90 active:scale-95;
            }
            .control-btn-outline {
                @apply border border-gray-300 hover:bg-gray-100 active:scale-95;
            }
        }
    </style>
</head>
<body class="font-inter bg-gray-50 text-dark min-h-screen flex flex-col">
    <!-- 顶部导航栏 -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fa fa-lightbulb-o text-primary text-2xl"></i>
                <h1 class="text-xl font-bold text-primary">STM32矩阵灯控制器</h1>
            </div>
            
            <div class="flex items-center gap-3">
                <div class="hidden md:flex items-center gap-1 text-sm">
                    <span id="connection-status" class="flex items-center gap-1">
                        <span class="w-2 h-2 rounded-full bg-danger"></span>
                        <span>未连接</span>
                    </span>
                </div>
                
                <button id="connect-btn" class="control-btn control-btn-primary text-sm">
                    <i class="fa fa-plug"></i>
                    <span>连接设备</span>
                </button>
                
                <button id="settings-btn" class="p-2 rounded-full hover:bg-gray-100 transition-colors">
                    <i class="fa fa-cog text-gray-600"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-1 container mx-auto px-4 py-6">
        <!-- 状态信息 -->
        <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h2 class="text-lg font-semibold mb-1">设备状态</h2>
                    <p class="text-sm text-gray-500">控制STM32矩阵灯的显示效果和颜色</p>
                </div>
                
                <div class="flex items-center gap-3 w-full md:w-auto">
                    <div class="flex-1 md:flex-none flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-1.5">
                        <i class="fa fa-microchip text-gray-500"></i>
                        <span id="device-info" class="text-sm">未选择设备</span>
                    </div>
                    
                    <div class="flex-1 md:flex-none flex items-center gap-2 bg-gray-100 rounded-lg px-3 py-1.5">
                        <i class="fa fa-th text-gray-500"></i>
                        <select id="matrix-size" class="bg-transparent text-sm focus:outline-none">
                            <option value="8x8">8×8 矩阵</option>
                            <option value="16x16">16×16 矩阵</option>
                            <option value="32x32">32×32 矩阵</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- 矩阵灯预览区 -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-sm p-4 h-full">
                    <h2 class="text-lg font-semibold mb-4">灯板预览</h2>
                    
                    <div class="flex justify-center items-center overflow-auto p-4 bg-gray-100 rounded-lg min-h-[300px] md:min-h-[400px]">
                        <div id="matrix-container" class="grid gap-[2px]">
                            <!-- 矩阵将通过JavaScript动态生成 -->
                        </div>
                    </div>
                    
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button class="control-btn control-btn-outline text-sm" data-action="clear">
                            <i class="fa fa-eraser"></i> 清除
                        </button>
                        <button class="control-btn control-btn-outline text-sm" data-action="fill">
                            <i class="fa fa-fill"></i> 全亮
                        </button>
                        <button class="control-btn control-btn-outline text-sm" data-action="invert">
                            <i class="fa fa-exchange"></i> 反转
                        </button>
                        <button class="control-btn control-btn-primary text-sm" data-action="send">
                            <i class="fa fa-send"></i> 发送到设备
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 控制面板 -->
            <div>
                <div class="bg-white rounded-xl shadow-sm p-4 h-full">
                    <h2 class="text-lg font-semibold mb-4">控制面板</h2>
                    
                    <!-- 颜色选择 -->
                    <div class="mb-6">
                        <h3 class="text-sm font-medium text-gray-700 mb-2">选择颜色</h3>
                        <div class="grid grid-cols-6 gap-2 mb-3">
                            <div class="w-full aspect-square rounded-md bg-red-500 cursor-pointer color-option active" data-color="#ef4444"></div>
                            <div class="w-full aspect-square rounded-md bg-orange-500 cursor-pointer color-option" data-color="#f97316"></div>
                            <div class="w-full aspect-square rounded-md bg-yellow-500 cursor-pointer color-option" data-color="#eab308"></div>
                            <div class="w-full aspect-square rounded-md bg-green-500 cursor-pointer color-option" data-color="#22c55e"></div>
                            <div class="w-full aspect-square rounded-md bg-blue-500 cursor-pointer color-option" data-color="#3b82f6"></div>
                            <div class="w-full aspect-square rounded-md bg-purple-500 cursor-pointer color-option" data-color="#a855f7"></div>
                        </div>
                        <input type="color" id="custom-color" class="w-full h-10 rounded-md cursor-pointer" value="#ef4444">
                    </div>
                    
                    <!-- 亮度调节 -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-sm font-medium text-gray-700">亮度调节</h3>
                            <span id="brightness-value" class="text-sm text-gray-500">80%</span>
                        </div>
                        <input type="range" id="brightness" min="10" max="100" value="80" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
                    </div>
                    
                    <!-- 显示模式 -->
                    <div class="mb-6">
                        <h3 class="text-sm font-medium text-gray-700 mb-2">显示模式</h3>
                        <div class="grid grid-cols-2 gap-2">
                            <button class="control-btn control-btn-outline text-sm justify-start active" data-mode="static">
                                <i class="fa fa-square"></i> 静态
                            </button>
                            <button class="control-btn control-btn-outline text-sm justify-start" data-mode="blink">
                                <i class="fa fa-bolt"></i> 闪烁
                            </button>
                            <button class="control-btn control-btn-outline text-sm justify-start" data-mode="flow">
                                <i class="fa fa-random"></i> 流水
                            </button>
                            <button class="control-btn control-btn-outline text-sm justify-start" data-mode="breath">
                                <i class="fa fa-circle-o-notch"></i> 呼吸
                            </button>
                        </div>
                    </div>
                    
                    <!-- 速度调节 -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-sm font-medium text-gray-700">动画速度</h3>
                            <span id="speed-value" class="text-sm text-gray-500">中等</span>
                        </div>
                        <input type="range" id="speed" min="1" max="5" value="3" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>慢速</span>
                            <span>快速</span>
                        </div>
                    </div>
                    
                    <!-- 预设图案 -->
                    <div>
                        <h3 class="text-sm font-medium text-gray-700 mb-2">预设图案</h3>
                        <div class="grid grid-cols-3 gap-2">
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="heart">
                                <i class="fa fa-heart text-danger"></i>
                            </button>
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="smile">
                                <i class="fa fa-smile-o text-yellow-500"></i>
                            </button>
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="arrow">
                                <i class="fa fa-arrow-right text-primary"></i>
                            </button>
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="star">
                                <i class="fa fa-star text-yellow-500"></i>
                            </button>
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="chess">
                                <i class="fa fa-chess-board text-gray-600"></i>
                            </button>
                            <button class="aspect-square bg-gray-100 rounded-md flex items-center justify-center hover:bg-gray-200 transition-colors" data-pattern="rainbow">
                                <i class="fa fa-tint text-blue-500"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 历史记录 -->
        <div class="mt-6 bg-white rounded-xl shadow-sm p-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold">历史记录</h2>
                <button class="text-sm text-primary hover:underline">清除所有</button>
            </div>
            
            <div class="space-y-3 max-h-40 overflow-y-auto pr-2">
                <div class="text-sm text-gray-500 flex justify-between items-center pb-2 border-b border-gray-100">
                    <span><i class="fa fa-clock-o mr-2"></i>发送图案到设备</span>
                    <span>10:23</span>
                </div>
                <div class="text-sm text-gray-500 flex justify-between items-center pb-2 border-b border-gray-100">
                    <span><i class="fa fa-clock-o mr-2"></i>更改显示模式为流水</span>
                    <span>10:15</span>
                </div>
                <div class="text-sm text-gray-500 flex justify-between items-center pb-2 border-b border-gray-100">
                    <span><i class="fa fa-clock-o mr-2"></i>连接到STM32设备</span>
                    <span>10:10</span>
                </div>
                <div class="text-sm text-gray-500 flex justify-between items-center pb-2 border-b border-gray-100">
                    <span><i class="fa fa-clock-o mr-2"></i>更改矩阵大小为16×16</span>
                    <span>昨天</span>
                </div>
            </div>
        </div>
    </main>

    <!-- 底部信息栏 -->
    <footer class="bg-white border-t border-gray-200 py-4 mt-6">
        <div class="container mx-auto px-4 text-center text-sm text-gray-500">
            <p>STM32矩阵灯控制器 &copy; 2023 - 在线控制软件</p>
        </div>
    </footer>

    <!-- 连接设备模态框 -->
    <div id="connect-modal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-lg w-full max-w-md mx-4 transform scale-95 transition-transform duration-300">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center">
                <h3 class="text-lg font-semibold">连接设备</h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            
            <div class="p-5">
                <p class="text-sm text-gray-500 mb-4">请选择要连接的STM32设备</p>
                
                <div class="space-y-3 max-h-60 overflow-y-auto pr-2">
                    <div class="border border-gray-200 rounded-lg p-3 hover:bg-gray-50 cursor-pointer flex justify-between items-center">
                        <div>
                            <div class="font-medium">STM32 Matrix Light #001</div>
                            <div class="text-xs text-gray-500">192.168.1.105</div>
                        </div>
                        <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full">在线</span>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-3 hover:bg-gray-50 cursor-pointer flex justify-between items-center">
                        <div>
                            <div class="font-medium">STM32 Matrix Light #002</div>
                            <div class="text-xs text-gray-500">192.168.1.107</div>
                        </div>
                        <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full">在线</span>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-3 hover:bg-gray-50 cursor-pointer flex justify-between items-center">
                        <div>
                            <div class="font-medium">STM32 Matrix Light #003</div>
                            <div class="text-xs text-gray-500">192.168.1.112</div>
                        </div>
                        <span class="text-xs px-2 py-1 bg-gray-100 text-gray-800 rounded-full">离线</span>
                    </div>
                </div>
                
                <div class="mt-4">
                    <button id="manual-connect" class="w-full py-2 border border-gray-300 rounded-lg text-sm flex items-center justify-center gap-2 hover:bg-gray-50">
                        <i class="fa fa-plus"></i> 手动添加设备
                    </button>
                </div>
            </div>
            
            <div class="p-4 bg-gray-50 rounded-b-xl flex justify-end gap-3">
                <button id="cancel-connect" class="px-4 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-100">取消</button>
                <button id="confirm-connect" class="px-4 py-2 bg-primary text-white rounded-lg text-sm hover:bg-primary/90">连接</button>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let matrixSize = 8; // 默认8x8矩阵
        let selectedColor = '#ef4444'; // 默认选中的颜色
        let isConnected = false; // 连接状态
        
        // DOM元素
        const matrixContainer = document.getElementById('matrix-container');
        const matrixSizeSelect = document.getElementById('matrix-size');
        const colorOptions = document.querySelectorAll('.color-option');
        const customColorInput = document.getElementById('custom-color');
        const brightnessSlider = document.getElementById('brightness');
        const brightnessValue = document.getElementById('brightness-value');
        const speedSlider = document.getElementById('speed');
        const speedValue = document.getElementById('speed-value');
        const modeButtons = document.querySelectorAll('[data-mode]');
        const patternButtons = document.querySelectorAll('[data-pattern]');
        const actionButtons = document.querySelectorAll('[data-action]');
        const connectBtn = document.getElementById('connect-btn');
        const connectionStatus = document.getElementById('connection-status');
        const deviceInfo = document.getElementById('device-info');
        const connectModal = document.getElementById('connect-modal');
        const closeModal = document.getElementById('close-modal');
        const cancelConnect = document.getElementById('cancel-connect');
        const confirmConnect = document.getElementById('confirm-connect');
        
        // 初始化矩阵
        function initMatrix(size) {
            matrixContainer.innerHTML = '';
            matrixContainer.style.gridTemplateColumns = `repeat(${size}, minmax(0, 1fr))`;
            
            for (let i = 0; i < size * size; i++) {
                const cell = document.createElement('div');
                cell.classList.add('matrix-cell');
                cell.dataset.index = i;
                cell.dataset.active = 'false';
                cell.addEventListener('click', toggleCell);
                matrixContainer.appendChild(cell);
            }
        }
        
        // 切换单元格状态
        function toggleCell(e) {
            const cell = e.currentTarget;
            const isActive = cell.dataset.active === 'true';
            
            if (isActive) {
                cell.style.backgroundColor = '';
                cell.dataset.active = 'false';
            } else {
                cell.style.backgroundColor = selectedColor;
                cell.dataset.active = 'true';
            }
        }
        
        // 更新选中的颜色
        function updateSelectedColor(color) {
            selectedColor = color;
            customColorInput.value = color;
            
            // 更新颜色选项的激活状态
            colorOptions.forEach(option => {
                if (option.dataset.color === color) {
                    option.classList.add('ring-2', 'ring-primary', 'ring-offset-2');
                } else {
                    option.classList.remove('ring-2', 'ring-primary', 'ring-offset-2');
                }
            });
        }
        
        // 更新连接状态
        function updateConnectionStatus(connected, deviceName = '') {
            isConnected = connected;
            
            if (connected) {
                connectionStatus.innerHTML = '<span class="w-2 h-2 rounded-full bg-secondary"></span><span>已连接</span>';
                connectBtn.innerHTML = '<i class="fa fa-unplug"></i><span>断开连接</span>';
                deviceInfo.textContent = deviceName || 'STM32 设备';
            } else {
                connectionStatus.innerHTML = '<span class="w-2 h-2 rounded-full bg-danger"></span><span>未连接</span>';
                connectBtn.innerHTML = '<i class="fa fa-plug"></i><span>连接设备</span>';
                deviceInfo.textContent = '未选择设备';
            }
        }
        
        // 显示/隐藏连接模态框
        function toggleConnectModal(show) {
            if (show) {
                connectModal.classList.remove('opacity-0', 'pointer-events-none');
                connectModal.querySelector('div').classList.remove('scale-95');
                connectModal.querySelector('div').classList.add('scale-100');
            } else {
                connectModal.classList.add('opacity-0', 'pointer-events-none');
                connectModal.querySelector('div').classList.remove('scale-100');
                connectModal.querySelector('div').classList.add('scale-95');
            }
        }
        
        // 执行动作（清除、填充、反转、发送）
        function performAction(action) {
            const cells = document.querySelectorAll('.matrix-cell');
            
            switch(action) {
                case 'clear':
                    cells.forEach(cell => {
                        cell.style.backgroundColor = '';
                        cell.dataset.active = 'false';
                    });
                    break;
                    
                case 'fill':
                    cells.forEach(cell => {
                        cell.style.backgroundColor = selectedColor;
                        cell.dataset.active = 'true';
                    });
                    break;
                    
                case 'invert':
                    cells.forEach(cell => {
                        const isActive = cell.dataset.active === 'true';
                        if (isActive) {
                            cell.style.backgroundColor = '';
                            cell.dataset.active = 'false';
                        } else {
                            cell.style.backgroundColor = selectedColor;
                            cell.dataset.active = 'true';
                        }
                    });
                    break;
                    
                case 'send':
                    if (!isConnected) {
                        alert('请先连接设备');
                        return;
                    }
                    
                    // 收集矩阵数据
                    const matrixData = Array.from(cells).map(cell => ({
                        index: parseInt(cell.dataset.index),
                        active: cell.dataset.active === 'true',
                        color: cell.dataset.active === 'true' ? selectedColor : null
                    }));
                    
                    // 这里应该有发送数据到设备的逻辑
                    console.log('发送矩阵数据到设备:', {
                        matrixData,
                        brightness: brightnessSlider.value,
                        mode: document.querySelector('[data-mode].active').dataset.mode,
                        speed: speedSlider.value
                    });
                    
                    // 显示发送成功的提示
                    const notification = document.createElement('div');
                    notification.className = 'fixed bottom-4 right-4 bg-secondary text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center gap-2';
                    notification.innerHTML = '<i class="fa fa-check-circle"></i><span>已发送到设备</span>';
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.classList.add('opacity-0', 'transition-opacity', 'duration-500');
                        setTimeout(() => notification.remove(), 500);
                    }, 2000);
                    
                    break;
            }
        }
        
        // 应用预设图案
        function applyPattern(pattern) {
            // 先清除现有图案
            performAction('clear');
            
            const cells = document.querySelectorAll('.matrix-cell');
            const size = matrixSize;
            
            // 根据不同图案设置单元格状态
            switch(pattern) {
                case 'heart':
                    // 心形图案的坐标（适用于8x8矩阵）
                    const heartCoords = [
                        [3,1], [4,1],
                        [2,2], [3,2], [4,2], [5,2],
                        [1,3], [2,3], [3,3], [4,3], [5,3], [6,3],
                        [0,4], [1,4], [2,4], [3,4], [4,4], [5,4], [6,4], [7,4],
                        [1,5], [2,5], [3,5], [4,5], [5,5], [6,5],
                        [2,6], [3,6], [4,6], [5,6],
                        [3,7], [4,7]
                    ];
                    
                    heartCoords.forEach(([x, y]) => {
                        const index = y * size + x;
                        if (cells[index]) {
                            cells[index].style.backgroundColor = selectedColor;
                            cells[index].dataset.active = 'true';
                        }
                    });
                    break;
                    
                case 'smile':
                    // 笑脸图案
                    for (let y = 1; y < size - 1; y++) {
                        for (let x = 1; x < size - 1; x++) {
                            // 外圈
                            if (x === 1 || x === size - 2 || y === 1 || y === size - 2) {
                                const index = y * size + x;
                                cells[index].style.backgroundColor = selectedColor;
                                cells[index].dataset.active = 'true';
                            }
                            
                            // 眼睛
                            if ((y === 2 && x === 3) || (y === 2 && x === size - 4)) {
                                const index = y * size + x;
                                cells[index].style.backgroundColor = '';
                                cells[index].dataset.active = 'false';
                            }
                            
                            // 嘴巴
                            if (y > size/2 && y < size - 2 && (x > 2 && x < size - 3)) {
                                const index = y * size + x;
                                cells[index].style.backgroundColor = '';
                                cells[index].dataset.active = 'false';
                            }
                        }
                    }
                    break;
                    
                // 可以添加更多预设图案...
                default:
                    // 随机图案
                    cells.forEach(cell => {
                        if (Math.random() > 0.5) {
                            cell.style.backgroundColor = selectedColor;
                            cell.dataset.active = 'true';
                        }
                    });
            }
        }
        
        // 事件监听器
        matrixSizeSelect.addEventListener('change', (e) => {
            const [width] = e.target.value.split('x').map(Number);
            matrixSize = width;
            initMatrix(matrixSize);
        });
        
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                updateSelectedColor(option.dataset.color);
            });
        });
        
        customColorInput.addEventListener('input', (e) => {
            updateSelectedColor(e.target.value);
        });
        
        brightnessSlider.addEventListener('input', (e) => {
            brightnessValue.textContent = `${e.target.value}%`;
        });
        
        speedSlider.addEventListener('input', (e) => {
            const speedText = ['极慢', '慢速', '中等', '快速', '极快'];
            speedValue.textContent = speedText[e.target.value - 1];
        });
        
        modeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                modeButtons.forEach(b => b.classList.remove('active', 'bg-primary/10', 'border-primary'));
                btn.classList.add('active', 'bg-primary/10', 'border-primary');
            });
        });
        
        patternButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                applyPattern(btn.dataset.pattern);
            });
        });
        
        actionButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                performAction(btn.dataset.action);
            });
        });
        
        connectBtn.addEventListener('click', () => {
            if (isConnected) {
                updateConnectionStatus(false);
            } else {
                toggleConnectModal(true);
            }
        });
        
        closeModal.addEventListener('click', () => toggleConnectModal(false));
        cancelConnect.addEventListener('click', () => toggleConnectModal(false));
        
        confirmConnect.addEventListener('click', () => {
            updateConnectionStatus(true, 'STM32 Matrix Light #001');
            toggleConnectModal(false);
        });
        
        // 点击模态框外部关闭
        connectModal.addEventListener('click', (e) => {
            if (e.target === connectModal) {
                toggleConnectModal(false);
            }
        });
        
        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            initMatrix(matrixSize);
            updateSelectedColor(selectedColor);
            updateConnectionStatus(false);
            
            // 设置初始激活状态
            document.querySelector('[data-mode="static"]').classList.add('active', 'bg-primary/10', 'border-primary');
        });
    </script>
</body>
</html>
